<!DOCTYPE html><html lang="zh-CN"><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description"><title>ReactNative Tutorial | Septenary Blog</title><link rel="stylesheet" type="text/css" href="/blog/css/style.css?v=0.0.0"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/normalize/8.0.0/normalize.min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/pure/1.0.0/pure-min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/pure/1.0.0/grids-responsive-min.css"><link rel="stylesheet" href="//cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.min.css"><script type="text/javascript" src="//cdn.bootcss.com/jquery/3.3.1/jquery.min.js"></script><link rel="Shortcut Icon" type="image/x-icon" href="/blog/favicon.ico"><link rel="apple-touch-icon" href="/blog/apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" href="/blog/apple-touch-icon.png"><link rel="alternate" type="application/atom+xml" href="/blog/atom.xml"></head><body><div class="body_container"><div id="header"><div class="site-name"><h1 class="hidden">ReactNative Tutorial</h1><a id="logo" href="/blog/.">Septenary Blog</a><p class="description"></p></div><div id="nav-menu"><a class="current" href="/blog/."><i class="fa fa-home"> 首页</i></a><a href="/blog/archives/"><i class="fa fa-archive"> 归档</i></a><a href="/blog/about/"><i class="fa fa-user"> 关于</i></a><a href="/blog/atom.xml"><i class="fa fa-rss"> 订阅</i></a></div></div><div class="pure-g" id="layout"><div class="pure-u-1 pure-u-md-3-4"><div class="content_container"><div class="post"><h1 class="post-title">ReactNative Tutorial</h1><div class="post-meta">Dec 25, 2017<span> | </span><span class="category"><a href="/blog/categories/RN/">RN</a></span></div><div class="post-content"><h1 id="ReactNative-Tutorial"><a href="#ReactNative-Tutorial" class="headerlink" title="ReactNative Tutorial"></a>ReactNative Tutorial</h1><h2 id="Getting-Started"><a href="#Getting-Started" class="headerlink" title="Getting Started"></a>Getting Started</h2><h3 id="Environment"><a href="#Environment" class="headerlink" title="Environment"></a>Environment</h3><p>1.<strong>nodejs</strong></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">brew install node</span><br></pre></td></tr></table></figure>
<p>2.<strong>npm4</strong>  <a href="https://github.com/facebook/react-native/issues/14767" target="_blank" rel="noopener">why not npm5?</a></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install -g npm@4</span><br></pre></td></tr></table></figure>
<p>3.<strong>yarn</strong></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">brew install yarn</span><br></pre></td></tr></table></figure>
<p>4.<strong>watchman</strong></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">brew install watchman</span><br></pre></td></tr></table></figure>
<p><a href="https://stackoverflow.com/questions/16432071/how-to-fix-homebrew-permissions/16450503" target="_blank" rel="noopener">watchman permission</a> : <code>sudo chown -R $(whoami) $(brew --prefix)/*</code></p>
<p>5.<strong>react-native-cli</strong>  or  <del>create-react-native-app</del></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install -g react-native-cli</span><br></pre></td></tr></table></figure>
<h3 id="Run-it"><a href="#Run-it" class="headerlink" title="Run it"></a>Run it</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">react-native init ReactNativeTutorial</span><br></pre></td></tr></table></figure>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">react-native run-ios</span><br><span class="line">react-native run-android</span><br></pre></td></tr></table></figure>
<p><strong>Android issue</strong></p>
<ul>
<li>./android/gradle/wrapper/gradle-wrapper.properties</li>
<li>./android/build.gradle</li>
<li>./android/app/build.gradle</li>
<li>./android/local.properties</li>
<li>touch ~/.gradle/gradle.properties &amp;&amp; echo “org.gradle.daemon=true” &gt;&gt; ~/.gradle/gradle.properties</li>
</ul>
<p><strong>iOS issue</strong></p>
<ul>
<li><a href="https://stackoverflow.com/questions/39778607/error-running-react-native-app-from-terminal-ios" target="_blank" rel="noopener">xcrun: error</a> :  <em>Xcode/Setting/Location</em> -&gt; Command Line Tools</li>
</ul>
<h3 id="Developer-Menu"><a href="#Developer-Menu" class="headerlink" title="Developer Menu"></a>Developer Menu</h3><h3 id="How-it-works"><a href="#How-it-works" class="headerlink" title="How it works"></a>How it works</h3><p><img src="https://raw.githubusercontent.com/Ryfthink/ReactNativeTutorial/master/art/15135035648483.jpg" alt=""></p>
<h2 id="ES6-标准"><a href="#ES6-标准" class="headerlink" title="ES6 标准"></a>ES6 标准</h2><p><a href="http://es6.ruanyifeng.com/" target="_blank" rel="noopener">参考-1</a><br><a href="http://blog.kdchang.cc/2016/04/04/react-react-native-es5-es6-cheat-sheet" target="_blank" rel="noopener">参考-2</a></p>
<p> <strong>Modules</strong></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">'react'</span>;</span><br><span class="line"><span class="keyword">import</span> MyComponent <span class="keyword">from</span> <span class="string">'./MyComponent'</span>;</span><br><span class="line"><span class="keyword">import</span> &#123;parseData&#125; <span class="keyword">from</span> <span class="string">'./xxx'</span>;</span><br><span class="line"><span class="keyword">import</span> * <span class="keyword">as</span> APIs <span class="keyword">from</span> <span class="string">'../constants/ServerAPIs'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="class"><span class="keyword">class</span> <span class="title">MyComponent</span> <span class="keyword">extends</span> <span class="title">Compoent</span> </span>&#123;</span><br><span class="line">	</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">parseData</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>Classes &amp; Method</strong></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Photo</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line">  handleClick(event) &#123;</span><br><span class="line">  &#125;</span><br><span class="line">  render() &#123;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>Property initializers</strong></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Todo</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line">    render() &#123;</span><br><span class="line">        <span class="keyword">return</span> (</span><br><span class="line">            &lt;Text&gt;Hello&lt;<span class="regexp">/Text&gt;</span></span><br><span class="line"><span class="regexp">        );</span></span><br><span class="line"><span class="regexp">    &#125;</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br><span class="line"><span class="regexp">Todo.defaultProps = &#123;</span></span><br><span class="line"><span class="regexp">    checked: false,</span></span><br><span class="line"><span class="regexp">    maxLength: 10,</span></span><br><span class="line"><span class="regexp">&#125;;</span></span><br><span class="line"><span class="regexp">Todo.propTypes = &#123;</span></span><br><span class="line"><span class="regexp">    checked: React.PropTypes.bool.isRequired,</span></span><br><span class="line"><span class="regexp">    maxLength: React.PropTypes.number.isRequired,</span></span><br><span class="line"><span class="regexp">&#125;;</span></span><br></pre></td></tr></table></figure>
<p><strong>State</strong></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Todo</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line">    state = &#123;</span><br><span class="line">        maxLength: <span class="keyword">this</span>.props.maxLength,</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Todo</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line">    <span class="keyword">constructor</span>(props)&#123;</span><br><span class="line">        <span class="keyword">super</span>(props);</span><br><span class="line">        <span class="keyword">this</span>.state = &#123;</span><br><span class="line">            maxLength: <span class="keyword">this</span>.props.maxLength,</span><br><span class="line">        &#125;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>Arrow functions</strong></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Todo</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line">    render()&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">TouchableOpacity</span> <span class="attr">onPress</span>=<span class="string">&#123;()</span> =&gt;</span> console.log("Arrow function called") &#125;&#125;/&gt;</span></span><br><span class="line"><span class="xml">    &#125;</span></span><br><span class="line"><span class="xml">&#125;</span></span><br></pre></td></tr></table></figure>
<p><strong>Dynamic property names &amp; template strings</strong></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> name = <span class="string">"Bob"</span>, time = <span class="string">"today"</span>;</span><br><span class="line"><span class="keyword">let</span> msg = <span class="string">`Hello <span class="subst">$&#123;name&#125;</span>, how are you <span class="subst">$&#123;time&#125;</span>?`</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> stateName = <span class="string">"toggle"</span></span><br><span class="line"><span class="keyword">this</span>.setState(&#123; [<span class="string">`<span class="subst">$&#123;stateName&#125;</span>Value`</span>]: <span class="literal">true</span> &#125;);</span><br></pre></td></tr></table></figure>
<p><strong>Destructuring &amp; spread attributes</strong></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Todo</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line">  render() &#123;</span><br><span class="line">    <span class="keyword">var</span> &#123;</span><br><span class="line">      className,</span><br><span class="line">      ...others,  <span class="comment">// ...others 包含 this.props 除了 className 外所有值。this.props = &#123;value: 'true', title: 'header', className: 'content'&#125;</span></span><br><span class="line">    &#125; = <span class="keyword">this</span>.props;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      &lt;div className=&#123;className&#125;&gt;</span><br><span class="line">        &lt;TodoList &#123;...others&#125; /&gt;</span><br><span class="line">        &lt;button onClick=&#123;<span class="keyword">this</span>.handleLoadMoreClick&#125;&gt;Load more&lt;<span class="regexp">/button&gt;</span></span><br><span class="line"><span class="regexp">      &lt;/</span>div&gt;</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>Default Parameters</strong></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">test</span>(<span class="params">height = <span class="number">50</span>, color = <span class="string">'red'</span></span>) </span>&#123;  </span><br><span class="line">  ...  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="Component"><a href="#Component" class="headerlink" title="Component"></a>Component</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">CustomComponent</span> <span class="keyword">extends</span> <span class="title">Component</span> </span>&#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="JSX"><a href="#JSX" class="headerlink" title="JSX"></a>JSX</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">CustomComponent</span> <span class="keyword">extends</span> <span class="title">Component</span> </span>&#123;</span><br><span class="line">    render() &#123;  </span><br><span class="line">        &lt;View&gt;</span><br><span class="line">          &lt;Text&gt;This is a title!<span class="xml"><span class="tag">&lt;/<span class="name">Text</span>&gt;</span></span></span><br><span class="line">          &lt;View&gt;</span><br><span class="line">            &lt;Text&gt;This is a Summary&lt;<span class="regexp">/Text&gt;</span></span><br><span class="line"><span class="regexp">          &lt;/</span>View&gt;</span><br><span class="line">        &lt;<span class="regexp">/View&gt;</span></span><br><span class="line"><span class="regexp">    &#125;</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br></pre></td></tr></table></figure>
<h3 id="props-amp-state"><a href="#props-amp-state" class="headerlink" title="props &amp; state"></a>props &amp; state</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">// 父组件</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ParentComponent</span> <span class="keyword">extends</span> <span class="title">Component</span></span>&#123;</span><br><span class="line">    <span class="keyword">constructor</span>(props) &#123;</span><br><span class="line">        <span class="keyword">super</span>(props)</span><br><span class="line">        <span class="keyword">this</span>.state = &#123;</span><br><span class="line">            childName = <span class="string">"子组件"</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    render()&#123;</span><br><span class="line">        <span class="keyword">return</span>(</span><br><span class="line">            &lt;ChildComponent name=&#123;<span class="keyword">this</span>.state.childName&#125;&gt;</span><br><span class="line">        )</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 子组件</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ChildComponent</span> <span class="keyword">extends</span> <span class="title">Component</span></span>&#123;</span><br><span class="line">    render()&#123;</span><br><span class="line">        <span class="keyword">return</span>(</span><br><span class="line">            &lt;Text&gt;&#123;<span class="keyword">this</span>.props.name&#125;&lt;<span class="regexp">/Text&gt;</span></span><br><span class="line"><span class="regexp">        )</span></span><br><span class="line"><span class="regexp">    &#125;</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br></pre></td></tr></table></figure>
<h3 id="Lifecycle"><a href="#Lifecycle" class="headerlink" title="Lifecycle"></a>Lifecycle</h3><p><img src="https://raw.githubusercontent.com/Ryfthink/ReactNativeTutorial/master/art/15138721832230.jpg" alt=""></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 组件开始装载之前调用，在一次生命周期中只会执行一次。</span></span><br><span class="line">componentWillMount()</span><br><span class="line"></span><br><span class="line"><span class="comment">// 组件完成装载之后调用，在一次生命周期中只会执行一次，从这里开始就可以对组件进行各种操作了，比如在组件装载完成后要显示的时候执行动画。</span></span><br><span class="line">componentDidMount()</span><br><span class="line"></span><br><span class="line"><span class="comment">// 组件属性更新之前调用，每一次属性更新都会调用</span></span><br><span class="line">componentWillUpdate(object nextProps, object nextState)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// 组件属性更新之后调用，每次属性更新都会调用</span></span><br><span class="line">componentDidUpdate(object prevProps, object prevState)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 组件卸载之前调用</span></span><br><span class="line">componentWillUnmount()</span><br></pre></td></tr></table></figure>
<h3 id="Style-amp-FlexBox"><a href="#Style-amp-FlexBox" class="headerlink" title="Style &amp; FlexBox"></a>Style &amp; FlexBox</h3><p><img src="https://raw.githubusercontent.com/Ryfthink/ReactNativeTutorial/master/art/15138754176654.png" alt=""></p>
<h2 id="组件使用"><a href="#组件使用" class="headerlink" title="组件使用"></a>组件使用</h2><h3 id="Image"><a href="#Image" class="headerlink" title="Image"></a>Image</h3><p><strong>本地图片</strong></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;Image source=&#123;<span class="built_in">require</span>(<span class="string">'./assets/email.png'</span>)&#125;/&gt;</span><br></pre></td></tr></table></figure>
<p>Packager 会打包所有的图片并且依据屏幕精度提供对应的资源。比如: <strong>iPhone 6</strong> 会使用 <a href="mailto:email@2x.png" target="_blank" rel="noopener">email@2x.png</a>，而 <strong>Pixel</strong> 上则会使用 <a href="mailto:email@3x.png" target="_blank" rel="noopener">email@3x.png</a>。如果没有图片恰好满足屏幕分辨率，则会自动选中最接近的一个图片。</p>
<p><strong>网络图片</strong></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;Image source=&#123;&#123; <span class="attr">uri</span>: <span class="string">'https//assets.domain/xxx.jpg'</span>&#125;&#125;</span><br></pre></td></tr></table></figure>
<p><a href="https://segmentfault.com/a/1190000002933776" target="_blank" rel="noopener">ATS issue</a><br><img src="https://raw.githubusercontent.com/Ryfthink/ReactNativeTutorial/master/art/15138869293237.jpg" alt=""></p>
<h3 id="ListView"><a href="#ListView" class="headerlink" title="ListView"></a>ListView</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;ListView</span><br><span class="line">    dataSource=&#123;...&#125;</span><br><span class="line">    renderRow=&#123;...&#125;</span><br><span class="line">/&gt;</span><br></pre></td></tr></table></figure>
<h3 id="Animation"><a href="#Animation" class="headerlink" title="Animation"></a>Animation</h3><p><a href="http://www.alloyteam.com/2016/01/reactnative-animated/" target="_blank" rel="noopener">参考</a></p>
<h2 id="Network"><a href="#Network" class="headerlink" title="Network"></a>Network</h2><p>React Native 提供了和 web 标准一致的Fetch API</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">fetch(&apos;https://mywebsite.com/endpoint/&apos;, &#123;</span><br><span class="line">  method: &apos;POST&apos;,</span><br><span class="line">  headers: &#123;</span><br><span class="line">    &apos;Accept&apos;: &apos;application/json&apos;,</span><br><span class="line">    &apos;Content-Type&apos;: &apos;application/json&apos;,</span><br><span class="line">  &#125;,</span><br><span class="line">  body: JSON.stringify(&#123;</span><br><span class="line">    firstParam: &apos;yourValue&apos;,</span><br><span class="line">    secondParam: &apos;yourOtherValue&apos;,</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<h2 id="AsyncStorage"><a href="#AsyncStorage" class="headerlink" title="AsyncStorage"></a>AsyncStorage</h2><p>是一个简单的、异步的、持久化的 <strong>key-value</strong> 存储系统，它对于App来说是全局性的。它用来代替 <strong>LocalStorage</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">async saveUserName(account: String) &#123;</span><br><span class="line">    let key = &apos;@key-user-name&apos;;</span><br><span class="line">    try &#123;</span><br><span class="line">        await AsyncStorage.setItem(key, account);</span><br><span class="line">    &#125; catch (error) &#123;</span><br><span class="line">        console.warn(error)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">async getUserName() &#123;</span><br><span class="line">    let key = &apos;@key-user-name&apos;;</span><br><span class="line">    try &#123;</span><br><span class="line">        return await AsyncStorage.getItem(key);</span><br><span class="line">    &#125; catch (error) &#123;</span><br><span class="line">        console.warn(error)</span><br><span class="line">    &#125;</span><br><span class="line">    return null;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h2 id="NativeBridge"><a href="#NativeBridge" class="headerlink" title="NativeBridge"></a>NativeBridge</h2><p><img src="https://raw.githubusercontent.com/Ryfthink/ReactNativeTutorial/master/art/15138857931917.jpg" alt=""></p>
<h2 id="打包"><a href="#打包" class="headerlink" title="打包"></a>打包</h2><h3 id="iOS"><a href="#iOS" class="headerlink" title="iOS"></a>iOS</h3><p>1.执行打包命令</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">react-native bundle --entry-file index.js --platform ios --dev false --bundle-output release_ios/main.jsbundle --assets-dest release_ios/</span><br></pre></td></tr></table></figure>
<p><img src="https://raw.githubusercontent.com/Ryfthink/ReactNativeTutorial/master/art/15138868113330.jpg" alt=""></p>
<p>2.将 <strong>assets</strong> 与 <strong>main.jsbundle</strong> 添加到项目中<br><img src="https://raw.githubusercontent.com/Ryfthink/ReactNativeTutorial/master/art/15138870589984.jpg" alt=""></p>
<p>3.修改 <strong>AppDelegate.m</strong>，让 React Native 去使用我们刚才导入的 <strong>jsbundle</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">- (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions</span><br><span class="line">&#123;</span><br><span class="line">    </span><br><span class="line">  NSURL *jsCodeLocation;</span><br><span class="line"> //jsCodeLocation = [[RCTBundleURLProvider sharedSettings] jsBundleURLForBundleRoot:@&quot;index.ios&quot; fallbackResource:nil];</span><br><span class="line"> +jsCodeLocation = [[NSBundle mainBundle] URLForResource:@&quot;main&quot; withExtension:@&quot;jsbundle&quot;];</span><br><span class="line">#endif</span><br><span class="line">...</span><br><span class="line">  return YES;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>4.在 <a href="https://itunesconnect.apple.com" target="_blank" rel="noopener">iTunes Connect</a> 创建应用 ➜ 打包程序 ➜ 将应用提交到app store</p>
<h3 id="Android"><a href="#Android" class="headerlink" title="Android"></a>Android</h3><p><a href="https://developer.android.com/studio/publish/app-signing.html" target="_blank" rel="noopener">参考</a></p>
<ol>
<li>生成证书</li>
<li>配置gradle</li>
</ol>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">android &#123;      </span><br><span class="line">    signingConfigs &#123;  </span><br><span class="line">        release &#123;  </span><br><span class="line">            storeFile file_dir</span><br><span class="line">            storePassword store_assword</span><br><span class="line">            keyAlias alias</span><br><span class="line">            keyPassword keyp_assword  </span><br><span class="line">        &#125;  </span><br><span class="line">    &#125;  </span><br><span class="line">    buildTypes &#123;  </span><br><span class="line">        release &#123;   </span><br><span class="line">            signingConfig signingConfigs.release  </span><br><span class="line">        &#125;  </span><br><span class="line">    &#125;  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>3.打包 APK</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./gradlew assembleRelease</span><br></pre></td></tr></table></figure>
<h2 id="热更新"><a href="#热更新" class="headerlink" title="热更新"></a>热更新</h2><h3 id="codepush"><a href="#codepush" class="headerlink" title="codepush"></a>codepush</h3><p><a href="https://microsoft.github.io/code-push/" target="_blank" rel="noopener">https://microsoft.github.io/code-push/</a></p>
<h3 id="自己实现"><a href="#自己实现" class="headerlink" title="自己实现"></a>自己实现</h3><p><a href="http://www.lcode.org/react-native-hot-update/" target="_blank" rel="noopener">参考1</a><br><a href="http://www.jianshu.com/p/2cb3eb9604ca" target="_blank" rel="noopener">参考2</a></p>
<p>以 Android 为例</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">react-native bundle --entry-file index.js --platform android --dev false --bundle-output release_android/main.jsbundle --assets-dest release_android/</span><br></pre></td></tr></table></figure>
<ul>
<li>1.初始项目发布时，生成并保留一份 <strong>bundle</strong> 文件。</li>
<li>2.有版本更新时，生成新的  <strong>bundle</strong> 文件，</li>
<li>3.使用 <strong>google-diff-match-patch</strong> 对比两个文件，并生成差异补丁文件。</li>
<li>4.App 下载补丁文件，再使用 <strong>google-diff-match-patch</strong> 和 assets 目录下的初始版本合并，生成新的 <strong>bundle</strong> 文件。</li>
</ul>
<p><img src="https://raw.githubusercontent.com/Ryfthink/ReactNativeTutorial/master/art/15138880360088.jpg" alt=""></p>
</div><div class="tags"></div><div class="post-nav"><a class="pre" href="/blog/2018/03/18/pub-clipkg-npm-repo/">Publishing cli-package to npm repository</a><a class="next" href="/blog/2017/05/23/elasticsearch-delete-indices-period/">ElasticSearch 定期删除过期索引</a></div><div id="container"></div><link rel="stylesheet" type="text/css" href="//unpkg.com/gitalk/dist/gitalk.css?v=0.0.0"><script type="text/javascript" src="//unpkg.com/gitalk/dist/gitalk.min.js?v=0.0.0"></script><script>var gitalk = new Gitalk({
  clientID: 'b9c9fa93919f96a68da2',
  clientSecret: 'a6f794fb428cf3622e117143d47e3dc9950b937f',
  repo: 'blog-comment',
  owner: 'ryfthink',
  admin: ['ryfthink'],
  distractionFreeMode: false,
  id: location.pathname
})
gitalk.render('container')
</script></div></div></div><div class="pure-u-1-4 hidden_mid_and_down"><div id="sidebar"><div class="widget"><div class="search-form"><input id="local-search-input" placeholder="Search" type="text" name="q" results="0"/><div id="local-search-result"></div></div></div><div class="widget"><div class="widget-title"><i class="fa fa-folder-o"> 分类</i></div><ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/blog/categories/Android/">Android</a></li><li class="category-list-item"><a class="category-list-link" href="/blog/categories/Chore/">Chore</a></li><li class="category-list-item"><a class="category-list-link" href="/blog/categories/Linux/">Linux</a></li><li class="category-list-item"><a class="category-list-link" href="/blog/categories/RN/">RN</a></li><li class="category-list-item"><a class="category-list-link" href="/blog/categories/devOps/">devOps</a></li><li class="category-list-item"><a class="category-list-link" href="/blog/categories/github/">github</a></li><li class="category-list-item"><a class="category-list-link" href="/blog/categories/mac/">mac</a></li><li class="category-list-item"><a class="category-list-link" href="/blog/categories/node/">node</a></li><li class="category-list-item"><a class="category-list-link" href="/blog/categories/它山之石/">它山之石</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-file-o"> 最近文章</i></div><ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/blog/2018/05/30/如何像天才一样说俏皮话？/">如何像天才一样说俏皮话？</a></li><li class="post-list-item"><a class="post-list-link" href="/blog/2018/03/18/pub-clipkg-npm-repo/">Publishing cli-package to npm repository</a></li><li class="post-list-item"><a class="post-list-link" href="/blog/2017/12/25/react-native-tutorial/">ReactNative Tutorial</a></li><li class="post-list-item"><a class="post-list-link" href="/blog/2017/05/23/elasticsearch-delete-indices-period/">ElasticSearch 定期删除过期索引</a></li><li class="post-list-item"><a class="post-list-link" href="/blog/2017/05/23/logstash-mapping-config/">Logstash Mapping 配置</a></li><li class="post-list-item"><a class="post-list-link" href="/blog/2017/05/16/logstash-pipeline-config/">Logstash Pipeline 配置</a></li><li class="post-list-item"><a class="post-list-link" href="/blog/2017/05/05/node-login-module/">mean.septenary.cn 搭建之登录逻辑梳理</a></li><li class="post-list-item"><a class="post-list-link" href="/blog/2017/03/24/logstash-intergration-aliyun-oss-plugin/">Logstash 集成 aliyun/oss 插件</a></li><li class="post-list-item"><a class="post-list-link" href="/blog/2017/03/17/filebeats-in-logstash/">Logstash 之 filebeats</a></li><li class="post-list-item"><a class="post-list-link" href="/blog/2017/03/16/how-to-intergration-logstash-plugin-2/">Logstash 插件集成</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-external-link"> 友情链接</i></div><ul></ul><a href="http://mean.septenary.cn" title="MEAN栈博客" target="_blank">MEAN栈博客</a><ul></ul><a href="https://www.jianshu.com/u/af0f90bf5ff5" title="馒头映像" target="_blank">馒头映像</a><ul></ul><a href="https://ryfthink.github.io/azhong/" title="AZhongArtist" target="_blank">AZhongArtist</a><ul></ul><a href="https://www.jianshu.com/u/67eb55a34561" title="剑老湿" target="_blank">剑老湿</a></div></div></div><div class="pure-u-1 pure-u-md-3-4"><div id="footer">Copyright © 2018 <a href="/blog/." rel="nofollow">Septenary Blog</a></div></div></div><a class="show" id="rocket" href="#top"></a><script type="text/javascript" src="/blog/js/totop.js?v=0.0.0" async></script><script type="text/javascript" src="//cdn.bootcss.com/fancybox/3.2.5/jquery.fancybox.min.js" async></script><script type="text/javascript" src="/blog/js/fancybox.js?v=0.0.0" async></script><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/fancybox/3.2.5/jquery.fancybox.min.css"><script type="text/javascript" src="/blog/js/search.js?v=0.0.0"></script><script>var search_path = 'search.xml';
if (search_path.length == 0) {
   search_path = 'search.xml';
}
var path = '/blog/' + search_path;
searchFunc(path, 'local-search-input', 'local-search-result');
</script><script type="text/javascript" src="/blog/js/codeblock-resizer.js?v=0.0.0"></script><script type="text/javascript" src="/blog/js/smartresize.js?v=0.0.0"></script></div></body></html>